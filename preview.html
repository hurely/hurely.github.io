<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>极简代码预览器</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        html,body{height:100%;}
        body{display:flex;flex-direction:column;background:#111;color:#eee;font-family:monospace;}

        /* 编辑态 */
        .edit .toolbar{
            display:flex;align-items:center;justify-content:space-between;
            padding:.5rem .75rem;background:#222;border-bottom:1px solid #444;flex-shrink:0;
        }
        .edit .btn{
            background:#444;color:#eee;border:none;padding:.4rem .8rem;border-radius:4px;font-size:.9rem;cursor:pointer;
        }
        .edit .btn:hover{background:#555;}
        .edit .main{flex:1;display:flex;min-height:0;}
        .edit .codeWrap{flex:1;display:flex;flex-direction:border-right:1px solid #444;}
        .edit textarea{
            flex:1;width:100%;height:100%;background:#0d1117;color:#c9d1d9;border:none;
            padding:1rem;resize:none;outline:none;font-family:monospace;font-size:14px;line-height:1.5;
        }
        .edit .previewWrap{flex:1;display:flex;flex-direction:column;}
        .edit iframe{
            flex:1;width:100%;height:100%;background:#fff;border:none;
        }

        /* 预览态 */
        .previewOnly iframe{
            position:fixed;inset:0;width:100vw;height:100vh;border:none;background:#fff;
        }
        .previewOnly .toolbar,.previewOnly .codeWrap{display:none;}

        /* 提示条 */
        #tip{
            position:fixed;bottom:1rem;left:50%;transform:translateX(-50%);
            background:rgba(0,0,0,.7);color:#fff;padding:.4rem .8rem;border-radius:4px;font-size:.8rem;
            opacity:0;transition:opacity .3s;pointer-events:none;
        }
        #tip.show{opacity:1;}
    </style>
</head>
<body class="edit">
    <div class="toolbar">
        <span>代码 → 预览</span>
        <div>
            <button class="btn" id="runBtn">预览</button>
            <button class="btn" id="clearBtn">清空</button>
        </div>
    </div>

    <div class="main">
        <div class="codeWrap">
            <textarea id="code" placeholder="输入 HTML/CSS/JS 后点「预览」"></textarea>
        </div>
        <div class="previewWrap">
            <iframe id="preview" src="about:blank"></iframe>
        </div>
    </div>

    <div id="tip"></div>

    <script>
        const d=document;
        const $=q=>d.querySelector(q);
        const code=$('#code'), iframe=$('#preview'), tip=$('#tip'), run=$('#runBtn'), clear=$('#clearBtn');

        function showTip(txt){
            tip.textContent=txt;
            tip.classList.add('show');
            setTimeout(()=>tip.classList.remove('show'),1500);
        }

        function runCode(){
            const html=code.value.trim();
            if(!html) return showTip('代码为空');
            const doc=iframe.contentDocument;
            doc.open();
            doc.write(html);
            doc.close();
            d.body.className='previewOnly';
            showTip('双击屏幕返回编辑');
        }

        function backToEdit(){
            d.body.className='edit';
            showTip('已返回编辑');
        }

        run.onclick=runCode;
        clear.onclick=()=>{ if(confirm('清空？')) code.value=''; };
        d.addEventListener('dblclick',backToEdit);
        d.addEventListener('touchend',(e)=>{
            const t=Date.now();
            if(t-(d._last||0)<300) backToEdit();
            d._last=t;
        });

        window.onload=()=>showTip('输入代码后点「预览」；双击屏幕可返回');
    </script>
</body>
</html>
